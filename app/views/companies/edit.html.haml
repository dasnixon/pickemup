#housing
  .container
    .pull-right
      - if @company.subscription
        #{link_to "Change Billing Info", edit_company_subscription_path(id: @subscription.id, company_id: @company.id), class: 'btn btn-success'}
      - if current_company.active?
        = link_to 'Deactivate Account', toggle_activation_company_path(id: current_company.id), method: :put, class: 'btn btn-danger', style: 'margin-left: 5px;',
          confirm: 'Are you sure you want to deactivate your account? We will also be sure to put your subscription on hold.'
      - else
        = link_to 'Activate Account', toggle_activation_company_path(id: current_company.id), method: :put, class: 'btn btn-success', style: 'margin-left: 5px;'
    .section_header
      %h3 Company Info
    = form_for @company, html: { class: 'form-horizontal', multipart: true, id: 'fileupload' } do |f|
      .control-group
        .controls
          = image_tag(@company.get_logo, size: '100x100', class: 'img-rounded')
          %br
          %br
          %span.btn.btn-success.fileinput-button
            %i.icon-plus.icon-white
            %span Change Logo
            = f.file_field :logo
          %table.table.table-striped
            %tbody.files
      .control-group
        = f.label :email, class: 'control-label'
        .controls
          = f.text_field :email
      .control-group
        = f.label :name, class: 'control-label'
        .controls
          = f.text_field :name
      .control-group
        = f.label :description, class: 'control-label'
        .controls
          = f.text_area :description, class: 'ckeditor'
      .control-group
        = f.label :website, class: 'control-label'
        .controls
          = f.text_field :website
      .control-group
        = f.label :industry, class: 'control-label'
        .controls
          = f.text_field :industry
      .control-group
        = f.label "Type", class: 'control-label'
        .controls
          = f.select :size_definition, Preference::COMPANY_TYPES, include_blank: true
      .control-group
        = f.label "Number of Employees", class: 'control-label'
        .controls
          = f.text_field :num_employees
      .control-group
        = f.label "Publicly Held?", class: 'control-label'
        .controls
          = f.check_box :public
      .control-group
        = f.label "Year Founded", class: 'control-label'
        .controls
          = f.date_select :founded, start_year: 1995
      %h4 Change Password
      .control-group
        = f.label "New Password", class: 'control-label'
        .controls
          = f.password_field :password
      .control-group
        = f.label "New Password Confirmation", class: 'control-label'
        .controls
          = f.password_field :password_confirmation
      .control-group
        .controls
          = f.submit 'Save Company', class: 'btn', id: 'company_save'
:javascript
  var fileUploadErrors = {
    maxFileSize: 'File is too big',
    minFileSize: 'File is too small',
    acceptFileTypes: 'Filetype not allowed',
    maxNumberOfFiles: 'Max number of files exceeded',
    uploadedBytes: 'Uploaded bytes exceed file size',
    emptyResult: 'Empty file upload result'
  };
/ The template to display files available for upload
%script#template-upload{type: "text/x-tmpl"}
  {% for (var i=0, file; file=o.files[i]; i++) { %}
  <br />
  <tr class="template-upload">
  <td class="preview"><span class="img-rounded"></span></td>
  <td class="name"><span>{%=file.name%}</span></td>
  <td class="size"><span>{%=o.formatFileSize(file.size)%}</span></td>
  {% if (file.error) { %}
  <td class="error" colspan="2"><span class="label label-important">{%=locale.fileupload.error%}</span> {%=locale.fileupload.errors[file.error] || file.error%}</td>
  {% } else if (o.files.valid && !i) { %}
  {% } else { %}
  <td colspan="2"></td>
  {% } %}
  <td class="cancel">{% if (!i) { %}
  <button class="btn btn-warning">
  <i class="icon-ban-circle icon-white"></i>
  <span>{%=locale.fileupload.cancel%}</span>
  </button>
  {% } %}</td>
  </tr>
  {% } %}
/ The template to display files available for download
%script#template-download{type: "text/x-tmpl"}
  {% for (var i=0, file; file=o.files[i]; i++) { %}
  <br />
  <tr class="template-download">
  {% if (file.error) { %}
  <td></td>
  <td class="name"><span>{%=file.name%}</span></td>
  <td class="size"><span>{%=o.formatFileSize(file.size)%}</span></td>
  <td class="error" colspan="2"><span class="label label-important">{%=locale.fileupload.error%}</span> {%=locale.fileupload.errors[file.error] || file.error%}</td>
  {% } else { %}
  <td class="preview">{% if (file.thumbnail_url) { %}
  <a href="{%=file.url%}" title="{%=file.name%}" rel="gallery" download="{%=file.name%}"><img src="{%=file.thumbnail_url%}"></a>
  {% } %}</td>
  <td class="name">
  <a href="{%=file.url%}" title="{%=file.name%}" rel="{%=file.thumbnail_url&&'gallery'%}" download="{%=file.name%}">{%=file.name%}</a>
  </td>
  <td class="size"><span>{%=o.formatFileSize(file.size)%}</span></td>
  <td colspan="2"></td>
  {% } %}
  <td class="delete">
  <button class="btn btn-danger" data-type="{%=file.delete_type%}" data-url="{%=file.delete_url%}">
  <i class="icon-trash icon-white"></i>
  <span>{%=locale.fileupload.destroy%}</span>
  </button>
  <input type="checkbox" name="delete" value="1">
  </td>
  </tr>
  {% } %}
%script{charset: "utf-8", type: "text/javascript"}
  $(function () {
  \// Initialize the jQuery File Upload widget:
  $('#fileupload').fileupload({
  maxNumberOfFiles: 1,
  dataType: 'json',
  add: function (e, data) {
  $('#company_save').on('click', function() {
  data.submit();
  });
  },
  });
  });
